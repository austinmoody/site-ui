<div class="panel panel-default">
    <div class="panel-heading">
        <h2 class="panel-title">Validate XDR Messages Generated By Your System</h2>
    </div>
    <div class="panel-body">
        <p>In order to verify if your system is producing XDR messages per the IHE XDR profile used in the context of Direct Edge protocols.</p>
        <ul>
            <li>Send a message to <a href="{{ siteXdrEndpoint }}" target="_blank">{{ siteXdrEndpoint }}</a>.</li>
            <li>Successful processing of the message will give you a "Success" message.</li>
            <li>Any errors will be provided as a validation report.</li>
            <li>Search for messages received by SITE by entering a From Address.</li>
            <li>Please note that SITE message logs are purged often and older messages may not be available.</li>
        </ul>
        <div class="col-lg-12">
            <form name="messageLookupForm" #messageLookupForm="ngForm"
                  (ngSubmit)="onSubmit(messageLookupForm.value)"
                  class="form-horizontal">
                <div class="form-group row">
                    <label for="lookupKey">Enter Message From Address: </label>
                    <input id="lookupKey" class="form-control" name="lookupKey" [(ngModel)]="lookupKey" placeholder="admin@sitenv.com" tabindex="1" type="email" required>
                </div>
                <div class="form-group row">
                    <button id="messageLookupSubmit" type="submit" class="btn btn-primary start" tabindex="1">
                        <i class="glyphicon glyphicon-search"></i> <span>Search</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<modal #blockModal [keyboard]="false" [backdrop]="'static'">
    <modal-body>
        <div class="blockMsg">
            <i class="fa fa-spinner fa-pulse fa-5x fa-fw" aria-hidden="true"></i>
            <div>
                <h1>Searching...</h1>
            </div>
        </div>
    </modal-body>
</modal>
<modal #resultsModal cssClass="validation-modal-dialog">
    <modal-header>
        <h2>XDR Message Results</h2>
    </modal-header>
    <modal-body class="result-modal-body">
        <div class="col-lg-12 direct-message-body">
            <h4>Search Results for {{ lookupKey }}</h4>
            <accordion [showArrows]="true" [closeOthers]="true" [expandAll]="false">
                <accordion-group *ngFor="let r of searchResults; let i = index" heading="Message received on: {{ r.dateLogged }}">
                    <div>
                        <div class="col-lg-6">
                            <pre>
                                {{ r.request }}
                            </pre>
                        </div>
                        <div class="col-lg-6">
                            <pre>
                                {{ r.response }}
                            </pre>
                        </div>
                    </div>
                </accordion-group>
            </accordion>
        </div>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-primary" (click)="resultsModal.close()">Close</button>
    </modal-footer>
</modal>